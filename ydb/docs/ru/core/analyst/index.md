# Для аналитиков

В этом разделе собраны примеры и рекомендации по работе с [аналитическими (OLAP) сценариями](../faq/analytics.md) в {{ ydb-short-name }}.

## OLAP

[Online analytical processing (OLAP)](https://ru.wikipedia.org/wiki/OLAP) или интерактивная аналитическая обработка — это подход к обработке данных, позволяющий оперативно получать в структурированном виде срез из большого массива данных для их последующего анализа.

В отличие от online transaction processing (OLTP), OLAP в основном предназначен для анализа данных с более низким числом транзакций, но со значительно большим объёмом обрабатываемых данных. Для более эффективного выполнения OLAP-запросов, требуется другой принцип хранения данных, который реализуется в колоночных таблицах.

## Колоночные таблицы

В {{ ydb-short-name }} существует два основных типа таблиц — [строковые](./datamodel/table.md##row-oriented-tables) и [колоночные](./datamodel/table.md##column-oriented-tables). Для аналитических запросов в основном используются колоночные таблицы<!--, но {{ ydb-short-name }} также позволяет комбинировать запросы к колоночным и строчным таблицам в одной транзакции-->.

Колоночные таблицы {{ ydb-short-name }} хранят данные каждого столбца отдельно (независимо) от других столбцов. Такой принцип хранения данных оптимизирован для использования c OLAP-нагрузками, так как при построении аналитических отчетов часто используются лишь несколько столбцов из витрины данных и колоночное хранение позволяет считывать только те столбцы, которые непосредственно участвуют в запросе.

Аналитические запросы выполняются над большими объемами данных. {{ ydb-short-name }} позволяет максимально эффективно фильтровать столбцы колоночных таблиц и читать только те части столбцов, которые нужны для выполнения запросов.

Партиционирование колоночных таблиц выполняется не по первичному ключу, а по хэшу от него, чтобы один аналитический запрос можно было выполнять параллельно на нескольких серверных процессах {{ ydb-short-name }}, что позволяет эффективно обрабатывать терабайты данных.

Для широких колоночных таблиц (витрин данных) часто используются ненормализованные данные, и записи в таких таблицах часто содержат NULL-значения в неиспользуемых столбцах. Таблицы, в которых много пустых ячеек называют разреженными (sparse). Чтобы пустые
ячейки не занимали место на диске, {{ ydb-short-name }} использует две технологии эффективного
хранения разреженных таблиц:

- Если пустых ячеек немного, то {{ ydb-short-name }} хранит вместе с данными битовую маску, которая определяет, в каких ячейках есть данные.
- Если пустых ячеек много, то {{ ydb-short-name }} хранит только пары индекс-значение.

## Преимущества {{ ydb-short-name }} для OLAP

В основе преимуществ {{ ydb-short-name }} лежит её архитектура:

1. **Разделение слоёв для вычислений и для хранения данных** позволяет точечно расширять кластер {{ ydb-short-name }}:

    - Если в кластере {{ ydb-short-name }} достаточно ресурсов для хранения, но значительно увеличилось количество запросов к данным, достаточно добавить узлов баз данных для ускорения обработки запросов.

    - Если кластер {{ ydb-short-name }} справляется с обработкой запросов, но количество данных постоянно растёт, необходимо добавить узлов хранения.

1. **Единая платформа**. {{ ydb-short-name }} позволяет совмещать OLTP- и OLAP-нагрузки в рамках одной базы данных.

<!-- 1. При добавлении новых серверов в кластер {{ ydb-short-name }} необходимо максимально равномерно распределить данные по кластеру, чтобы обрабатывать их параллельно для скорейшего получения результата. **Перешардирование данных** в колоночных таблицах {{ ydb-short-name }} происходит почти мгновенно. Кроме того, при перешардировании колоночных таблиц кластер {{ ydb-short-name }} продолжает обрабатывать поступающие запросы пользователей. -->

## Сценарии

{{ ydb-short-name }} оптимизирована для работы с большими объёмами данных и применяется в сценариях, где требуется эффективная обработка, хранение и анализ данных.

- **Observability**. {{ ydb-short-name }} может использоваться как хранилище телеметрических данных (метрики, логи, трейсы) для обеспечения полной наблюдаемости различных систем.

    <!-- Благодаря поддержке широких таблиц, которые могут включать до 10000 колонок, {{ ydb-short-name }} позволяет создавать витрины для разнородных событий с большим числом полей, что особенно важно для логирования и трассировки сложных систем. -->

    <!-- Кроме того, {{ ydb-short-name }} поддерживает использование S3-совместимых хранилищ и охлаждение данных, что позволяет экономно масштабировать хранение исторических данных без потери в доступности. Такая архитектура делает её подходящей как для оперативного мониторинга, так и для длительного хранения данных с возможностью последующего анализа. -->

- **Аналитическая БД**. {{ ydb-short-name }} может применяться для выполнения сложной аналитики над большими объёмами данных. Она поддерживает стоимостной оптимизатор запросов и перешардирование колоночных таблиц, что делает её подходящей для построения отчётности, дашбордов и проведения ретроспективного анализа событий в системах.
<!-- Что-нибудь ещё? -->

## Аналитические возможности {{ ydb-short-name }}

- **Загрузка данных в {{ ydb-short-name }}**:

    - {{ ydb-short-name }} позволяет осуществлять **параллельную загрузку** данных в распределённую реляционную базу данных. Благодаря своей архитектуре, система может обрабатывать большие объёмы данных и обеспечивает высокую производительность при загрузке.

    - [**Федеративные запросы**](../concepts/federated_query/index.md). {{ ydb-short-name }} поддерживает перенос данных из различных внешних источников, таких как PostgreSQL (PG), Greenplum (GP), и S3. Это упрощает интеграцию с существующими системами и позволяет реализовать сценарии ETL (Extract, Transform, Load) и ELT (Extract, Load, Transform).

    - **Очереди сообщений {{ ydb-short-name }}**. В {{ ydb-short-name }} можно настроить автоматическое перекладывание структурированных данных из очереди сообщений в колоночную таблицу. Это особенно полезно для работы с потоковыми данными в реальном времени. Кроме того, в системе реализована возможность использовать Change Data Capture (CDC) потоки для переноса данных из строковых таблиц в колоночные.

    - **Интеграция со сторонними системами**. {{ ydb-short-name }} можно интегрировать с различными инструментами и системами для загрузки данных, такими как FluentBit и LogStash. {{ ydb-short-name }} также позволяет импортировать данные из JDBC-источников. Это расширяет возможности системы и упрощает разработку приложений для работы с данными.

- **Хранение данных**:

    - [**Колоночные таблицы**](../concepts/datamodel/table#column-tables) оптимизированы для аналитической нагрузки (OLAP) и позволяют хранить данные по колонкам вместо строк, что ускоряет агрегации, поиск и обработку больших объёмов информации. <!--Пользователь может добавлять до 10000 колонок в свои таблицы, что существенно больше, чем у конкурентов. {{ ydb-short-name }} также поддерживает выполнение смешанных запросов к колоночным и строчным таблицам. Это позволяет совмещать OLAP и OLTP обработку в одной базе данных. -->

    - YDB использует **ColumnStore** — механизм эффективного хранения большого количества таблиц с одинаковой схемой. ColumnStore позволяет создавать внутри себя десятки тысяч таблиц с одинаковой схемой данных. Отдельные таблицы могут иметь индивидуальные настройки, такие как TTL и параметры охлаждения данных.

    <!-- - {{ ydb-short-name }} поддерживает **охлаждение данных пользователя** в объектное хранилище S3 (tiering). Пользователь может настроить автоматический перенос данных колоночных таблиц между внутренним слоем хранения данных YDB и S3. Это позволяет управлять стоимостью хранения больших объёмов данных. Данные перенесённые в S3 остаются доступными для выполнения над ними SQL-запросов. -->

    - [**Workload Manager**](../dev/resource-consumption-management.md) позволяет распределять ресурсы системы между запросами пользователей и задавать ограничения на потребляемые одним запросом ресурсы кластера.

- **Обработка и анализ данных**:

    - Для оптимизации аналитических запросов {{ ydb-short-name }} позволяет использовать [**стоимостной оптимизатор запросов**](../concepts/optimizer.md#cost-based-optimizer), который рассматривает большое количество альтернативных планов выполнения и выбирает из них лучший на основе оценки стоимости каждого варианта.

    - **Интеграция со сторонними системами BI**. {{ ydb-short-name }} можно интегрировать с различными инструментами и системами для анализа данных, такими как Apache Superset, DataLens, FineBI, и Grafana.

## Данный раздел содержит следующие материалы

* [{#T}](scenarios.md)
* [{#T}](optimizing.md)
* [Импорт датасетов](datasets/index.md)

{% include [olap-links](_includes/olap-links.md) %}